# forecasting_customer_churn
Прогнозирование оттока – одна из востребованных задач, которая может решаться методами data science. Привлечение новых клиентов связано с затратами на рекламу и проведение акций, а на насыщенных рынках затруднено, поскольку приходится «переманивать» клиентов у конкурентов. Поэтому для снижения затрат на поддержание клиентской базы можно помимо регулирования притока новых клиентов также работать над снижением оттока существующих клиентов. Прогнозирование оттока связано с накоплением и исследованием данных о поведении клиента и поиске шаблонов поведения, коррелированных с событием ухода. Что считать уходом – зависит от бизнеса, например это может быть расторжение договора, непродление подписки, прекращение платежей за пользование продуктом, непосещение ресурса в течение заданного времени и т.п. 

Моделирование оттока полезно для решения двух задач:
-	выявления факторов, взаимосвязанных с оттоком, для улучшения обслуживания и качества продукта;
-	прогнозирование оттока для выявления склонных к нему клиентов для последующего воздействия на них с целью удержания (скидки, информирование об услугах, которые могли бы повысить ценность продукта для клиента и т.п).

Набор данных data.csv имеет 21 столбец:
1.	customerID: идентификатор клиента
2.	Gender: является ли клиент мужчиной или женщиной
3.	SeniorCitizen: является ли клиент пожилым гражданином (да, нет)
4.	Partner: есть ли у клиента партнер (да, нет)
5.	Dependents: есть ли у клиента иждивенцы (да, нет)
6.	Tenure: количество месяцев, в течение которых клиент оставался в компании
7.	PhoneService: есть ли у клиента телефония (да, нет)
8.	MultipleLines: есть ли у клиента несколько линий (да, нет, нет телефонии)
9.	InternetService: интернет-провайдер клиента (DSL, оптоволокно, нет)
10.	OnlineSecurity: есть ли у клиента онлайн-безопасность (да, нет, нет интернет-сервиса)
11.	OnlineBackup: есть ли у клиента онлайн-резервное копирование (да, нет, нет интернет-сервиса)
12.	DeviceProtection: есть ли у клиента защита устройства (да, нет, нет интернет-сервиса)
13.	TechSupport: есть ли у клиента техническая поддержка (да, нет, нет интернет-сервиса)
14.	StreamingTV: есть ли у клиента потоковое телевидение (да, нет, нет интернет-сервиса)
15.	StreamingMovies: есть ли у клиента потоковые фильмы (да, нет, нет интернет-сервиса)
16.	Contract: срок контракта клиента (ежемесячно, один год, два года)
17.	PaperlessBilling: есть ли у клиента безбумажный биллинг (да, нет)
18.	PaymentMethod: способ оплаты клиента (электронный чек, чек по почте, автоматический банковский перевод, автоплатеж с карты)
19.	MonthlyCharges: сумма, взимаемая с клиента ежемесячно
20.	TotalCharges: общая сумма, списанная с клиента
21.	Churn: ушел ли клиент или нет (да или нет)

В данном проекте решается задача прогнозирования оттока клиентов телекоммуникационной компании. Проект разделен на 2 части: анализ качества данных и моделирование. 

В первом разделе используются следующие технологии языка Python: **pandas**, **numpy** (для чтения, редактирования и удобного представления данных) и **missingno** (для построения матрицы пропусков по каждому столбцу). Анализ на наличие выбросов производится путем построения **ящиков с усами**, наглядно показывающих статистические характеристики распределения такие как медиана, границы квантилей и выбросы. К некоторым количественным характеристикам были применены алгоритмы **дискретизации** (столбец MonthlyCharges) и наглядно продемонстрирована необходимость этой операции (при помощи построения графика с использованием пакета **matplotlib**). Помимо этого в первом разделе можно увидеть анализ на корреляцию признаков (**seaborn**) и построение **тепловой карты**.

Во втором разделе производится **one-hot** кодирование количетвенных признаков для дальнейшей работы с моделями. В ходе работы рассматривается 3 типа моделей: **линейная регрессия** с округлением к ближайшему целому числу для реализации классификации,**k-ближайших соседей** и **ансамбли деревьев (Random Forest)**. В ходе моделирования производился анализ влияния нормировки и дополнительного корреляционного анализа на точность предсказаний. Помимо этого была использована технология over sampling (**SMOTE**) для балансировки обучающих данных, что заметно повысило точность предсказаний (с 0.6 до 0.8). 

В качестве итога можно отметить, что наилучшую точность продемоснтрировала модель Random Forest с параметром n_estimators = 69: **F1-score = 0,8516**.
